<!doctype html>
<html lang="en">
<head>
    <title>Code coverage report for libs/LivePersonVirtualAssistantModule.js</title>
    <meta charset="utf-8" />
    <link rel="stylesheet" href="../prettify.css" />
    <link rel="stylesheet" href="../base.css" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style type='text/css'>
        .coverage-summary .sorter {
            background-image: url(../sort-arrow-sprite.png);
        }
    </style>
</head>
<body>
<div class='wrapper'>
  <div class='pad1'>
    <h1>
      <a href="../index.html">all files</a> / <a href="index.html">libs/</a> LivePersonVirtualAssistantModule.js
    </h1>
    <div class='clearfix'>
      <div class='fl pad1y space-right2'>
        <span class="strong">44.06% </span>
        <span class="quiet">Statements</span>
        <span class='fraction'>89/202</span>
      </div>
      <div class='fl pad1y space-right2'>
        <span class="strong">20.71% </span>
        <span class="quiet">Branches</span>
        <span class='fraction'>29/140</span>
      </div>
      <div class='fl pad1y space-right2'>
        <span class="strong">39.39% </span>
        <span class="quiet">Functions</span>
        <span class='fraction'>13/33</span>
      </div>
      <div class='fl pad1y space-right2'>
        <span class="strong">44.06% </span>
        <span class="quiet">Lines</span>
        <span class='fraction'>89/202</span>
      </div>
    </div>
  </div>
  <div class='status-line low'></div>
<pre><table class="coverage">
<tr><td class="line-count quiet">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
243
244
245
246
247
248
249
250
251
252
253
254
255
256
257
258
259
260
261
262
263
264
265
266
267
268
269
270
271
272
273
274
275
276
277
278
279
280
281
282
283
284
285
286
287
288
289
290
291
292
293
294
295
296
297
298
299
300
301
302
303
304
305
306
307
308
309
310
311
312
313
314
315
316
317
318
319
320
321
322
323
324
325
326
327
328
329
330
331
332
333
334
335
336
337
338
339
340
341
342
343
344
345
346
347
348
349
350
351
352
353
354
355
356
357
358
359
360
361
362
363
364
365
366
367
368
369
370
371
372
373
374
375
376
377
378
379
380
381
382
383
384
385
386
387
388
389
390
391
392
393
394
395
396
397
398
399
400
401
402
403
404
405
406
407
408
409
410
411
412
413
414
415
416
417
418
419
420
421
422
423
424
425
426
427
428
429
430
431
432
433
434
435
436
437
438
439
440
441
442
443
444
445
446
447
448
449
450
451
452
453
454
455
456
457
458
459
460
461
462
463
464
465
466
467
468
469
470
471
472
473
474
475
476
477
478
479
480
481
482
483
484
485
486
487
488
489
490
491
492
493
494
495
496
497
498
499
500
501
502
503
504
505
506
507
508
509
510
511
512
513
514
515
516
517
518
519
520
521
522
523
524
525
526
527
528
529
530
531
532
533
534
535
536
537
538
539
540
541
542
543
544
545
546
547
548
549
550
551
552
553
554
555
556
557
558
559
560
561
562
563
564
565
566</td><td class="line-coverage quiet"><span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">6×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">3×</span>
<span class="cline-any cline-yes">3×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">2×</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span></td><td class="text"><pre class="prettyprint lang-js">var LivePersonVirtualAssistantModule = (function () {
  var _version = '2.0.2';
  var _config = {
    USING_PROXY_BUTTON: true,
    TRIGGER_CHAT_BUTTON_FROM_BUSY_STATE:false,
    TRIGGER_CHAT_BUTTON_FROM_OFFLINE_STATE:false,
    SEND_FAQ_CONVERSATION_AS_PRECHAT_LINES: true, 
    PRECHAT_LINES_INTRO_MESSAGE_ENABLED: true, 
    EMBEDDED_BUTTON_ID_LOADED: null,
    EMBEDDED_BUTTON_TYPE: 5,
    EMBEDDED_BUTTON_INFO: null,
    ENGAGEMENT_NAME_SHORTCODE: ':vap:',
    EMBEDDED_BUTTON_DIV_CONTAINER_ID: 'lpButtonDiv-need-help-panel',
    WINDOW_CLOSE_BUTTON_CLASS:'lp_close',
    NAMESPACE : 'LP_VA_PANEL_MODULE',
    EVENTS : {
      BUTTON_IMPRESSION:'EMBEDDED_BUTTON_IMPRESSION',
      SHOW:'SHOULD_SHOW_VA_PANEL',
      HIDE:'SHOULD_HIDE_VA_PANEL',
      BUTTON_TO_DISPLAY:'SHOULD_SHOW_BUTTON_CONTENT',
      CLOSE_THANKYOU_WINDOW:'DID_CLOSE_THANKYOU_WINDOW'
    }
  };
&nbsp;
  var _supportedLanguages = ['en','fr','zh_hans','zh','zh_tw','ar','bm','es','es_mx'];
  var _abandonedChatEvents = ['waiting','preChat','chatting','postChat'];
  var _translations = {
    'intro' : {
      'en':'en - Your conversation history so far...',
      'fr':'fr - ???...',
      'zh':'zh_hans - ???...',
      'zh_tw':'zh_hant - ???...',
      'ar':'ar - ???...',
      'bm':'bm - ???...',
      'es':'es - ???...',
      'es_mx':'es_mx - ???...',
      'zh_hans': 'zh_hans - ???...'
    },
    'suffix' : {
      'en': 'en - An Agent will be with you shortly...',
      'fr': 'fr - ???...',
      'zh': 'zh_hans - ???...',
      'zh_tw': 'zh_hant - ???...',
      'ar': 'ar - ???...',
      'bm': 'bm - ???...',
      'es': 'es - ???...',
      'es_mx': 'es_mx - ???...',
      'zh_hans': 'zh_hans - ???...'
    }
  };
&nbsp;
  var BUTTON_STATES = {
    'ONLINE':1,
    'OFFLINE':2,
    'BUSY':4,
    'UNKNOWN':0
  };
&nbsp;
  var BUTTON_STATE_DESCRIPTIONS = {
    1 : 'ONLINE',
    2 : 'OFFLINE',
    4 : 'BUSY',
    0 : 'UNKNOWN',
  };
&nbsp;
  var _eventBindingsDone = false;
&nbsp;
  var _eventLog = [];
&nbsp;
  function _log(name,event) {
    _eventLog.push({
      'name':name,
      'info':event,
      'timestamp':Date.now()
    });
  }
  function checkIfButtonImpressionIsForVaPanel(e, d) {
    
    /* 
     This event fires every time a button is displayed on the page
     You will need to check the e.engagementType value to see what type it is.
     5 = embedded but there may be more than one embedded button on some pages that are NOT va panel related.
     otherwise the engagementName property may give some indication if named correctly on the liveperson side.
    */
    // check if the type is embedded (5) AND the id matches the array constant of all ids on both accounts DEV/PROD
    // .match(/:vap:/g);
    var _regexCheckEngagementName = new RegExp(_config.ENGAGEMENT_NAME_SHORTCODE,'g');
    <span class="missing-if-branch" title="else path not taken" >E</span>if (e.engagementType == _config.EMBEDDED_BUTTON_TYPE &amp;&amp; _regexCheckEngagementName.test(e.engagementName) )
    {
      // means embedded button and the unique id the button matches the specific buttons we have configured with the LE2 system to be shown within the VA panel
      _config.EMBEDDED_BUTTON_ID_LOADED = e.engagementId; // store the value so we can use it later when we need to query the button state later in the process for an accurate value - this is in case the refresh timer has changed the state from online/offline and vice versa
      
      // trigger a custom event using the lpTag.events bridge to notify other parts of the code that we have successfull loaded the embedded button for VA panel
      var eventData = {
        id: e.engagementId,
        name: e.engagementName,
        cid: e.campaignId,
        state: e.state
      };
      lpTag.events.trigger(_config.NAMESPACE, _config.EVENTS.BUTTON_IMPRESSION,eventData);
      _log(_config.EVENTS.BUTTON_IMPRESSION, eventData);
    } 
  }
&nbsp;
&nbsp;
  function showTheLivePersonButtonInsideVaPanel(eventData) {
    // the hidden empty HTML button inside the va panel has been loaded
    // cache eventData object
    _config.EMBEDDED_BUTTON_INFO = eventData;
    // as this could happen many times for button on refresh rates, we should always hide both buttons by default and then reshow the relevant one...
    <span class="missing-if-branch" title="else path not taken" >E</span>if (_config.USING_PROXY_BUTTON) {
      
      var buttonStateKeys =  Object.keys(BUTTON_STATES);
      var data = {
        'reason': 'VA PANEL related button impression event detected - show the button content on the page based on the attached eventData.state property',
        'state': eventData.state,
        'status': BUTTON_STATE_DESCRIPTIONS[eventData.state],
        'state_descriptions': BUTTON_STATE_DESCRIPTIONS,
        'state_enums': BUTTON_STATES
      };
      _triggerEvent(_config.EVENTS.BUTTON_TO_DISPLAY, data );
    }
&nbsp;
  }
&nbsp;
<span class="fstat-no" title="function not covered" >  function getActiveButton() {</span>
<span class="cstat-no" title="statement not covered" >    return _config.EMBEDDED_BUTTON_INFO;</span>
  }
&nbsp;
  function chatWindowIsActive() {
    var _windowEvents = lpTag.events.hasFired('lpUnifiedWindow', 'state');
    <span class="missing-if-branch" title="if path not taken" >I</span>if (_windowEvents.length &gt; 0) {
      // the window has fired events meaning it is being shown - hide the panel
      // if you only want to hide on specific conditions check the values of _windowEvents[].data.state property
<span class="cstat-no" title="statement not covered" >      return true;</span>
    } else {
      return false;
    }
&nbsp;
  }
&nbsp;
  function _triggerEvent(name,data) {
    lpTag.events.trigger(_config.NAMESPACE, name, data);
    _log(name,data);
  }
&nbsp;
  function _init() {
    // bind to the window
    _eventLog = [];
    <span class="missing-if-branch" title="else path not taken" >E</span>if (lpTag &amp;&amp; lpTag.events &amp;&amp; lpTag.events.hasFired) {
      // events.hasFired exists - check if the lpTag window is already on the page before we got here?
      // if we find any events, we should hide the panel
      // var _windowEvents = lpTag.events.hasFired('lpUnifiedWindow', 'state');
      <span class="missing-if-branch" title="if path not taken" >I</span>if (chatWindowIsActive()) {
<span class="cstat-no" title="statement not covered" >        _triggerEvent(_config.EVENTS.HIDE,{</span>
          'reason':'hiding because chatWindowIsActive returned TRUE'
        });
      }
    }
    //still call bindToChatEvents so we listen for other events that may still fire.
    <span class="missing-if-branch" title="else path not taken" >E</span>if(_eventBindingsDone === false) {
      bindToChatEvents();
      addSurveyHooks();
      _eventBindingsDone = true;      
    } else {
<span class="cstat-no" title="statement not covered" >      _log('EVENT_BINDINGS_DONE',{'eventBindingsDone':_eventBindingsDone});</span>
    }
&nbsp;
  }
&nbsp;
  // workaround for #CMBWSUAT-31
<span class="fstat-no" title="function not covered" >  function checkWindowStatus(element) {</span>
<span class="cstat-no" title="statement not covered" >    var lpChatWindowEvents = lpTag.events.hasFired('lpUnifiedWindow', 'conversationInfo');</span>
<span class="cstat-no" title="statement not covered" >    _log('checkWindowStatus', { 'lpChatWindowEvents': lpChatWindowEvents });</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >    var lastEvent = lpChatWindowEvents[lpChatWindowEvents.length-1];</span>
<span class="cstat-no" title="statement not covered" >    var previousEvent = lpChatWindowEvents[lpChatWindowEvents.length - 2] || null;</span>
<span class="cstat-no" title="statement not covered" >    _log('previousEvent_and_lastEvent', { 'previousEvent': previousEvent,'lastEvent':lastEvent });</span>
&nbsp;
    /* 
      lastEvent == preChat/waiting/chatting/postChat =&gt; showPanel
      lastEvent == ended AND previousEvent = preChat/waiting/chatting/ =&gt; showPanel + closeThankyouWindow
&nbsp;
      lastEvent.data.state == 'preChat' || lastEvent.data.state == 'waiting' || lastEvent.data.state == 'chatting' || lastEvent.data.state == 'postChat'
    */
&nbsp;
<span class="cstat-no" title="statement not covered" >    if (  lastEvent.data.state </span>
        &amp;&amp; 
        _abandonedChatEvents.indexOf(lastEvent.data.state) &gt; -1  
    ) {
      // visitor abandonded without submitted survey or connecting to agent...show panel
<span class="cstat-no" title="statement not covered" >      _triggerEvent(_config.EVENTS.SHOW, {</span>
        'reason': 'visitor abandonded without submitting prechat survey / or connecting to agent / or did not submit post chat survey...show panel',
        'lastEvent' : lastEvent 
      });
    }
<span class="cstat-no" title="statement not covered" >    if( lastEvent.data.state </span>
        &amp;&amp;
        lastEvent.data.state == 'ended'
        &amp;&amp; 
        previousEvent.data.state
        &amp;&amp; 
        _abandonedChatEvents.indexOf(previousEvent.data.state) &gt; -1 
    ) {
<span class="cstat-no" title="statement not covered" >      _triggerEvent(_config.EVENTS.SHOW, {</span>
        'reason': 'lastEvent == ended AND previousEvent = preChat/waiting/chatting/ =&gt; showPanel + closeThankyouWindow',
        'lastEvent': lastEvent,
        'previousEvent':previousEvent
      });
<span class="cstat-no" title="statement not covered" >      closeThankyouWindow();</span>
    }
&nbsp;
<span class="cstat-no" title="statement not covered" >    if(lastEvent.data.state == 'postChat') {</span>
<span class="cstat-no" title="statement not covered" >      _log('closeThankyouWindow', { 'lastEvent': lastEvent});</span>
<span class="cstat-no" title="statement not covered" >      closeThankyouWindow();    </span>
    }
  }
&nbsp;
<span class="fstat-no" title="function not covered" >  function _handleBeforeSurveySubmitHook(options) {</span>
<span class="cstat-no" title="statement not covered" >    _log('BEFORE_SUBMIT_SURVEY', { 'options': options });</span>
<span class="cstat-no" title="statement not covered" >    var reason = null;</span>
<span class="cstat-no" title="statement not covered" >    var eventData = {</span>
      'options.data.surveyType': options.data.surveyType,
      'options.data.surveyData': options.data.surveyData,
      'reason': reason
    };
&nbsp;
<span class="cstat-no" title="statement not covered" >    if (options.data.surveyType == 'preChatSurvey' &amp;&amp; options.data.surveyData === null) {</span>
<span class="cstat-no" title="statement not covered" >      eventData.reason = 'BEFORE_SUBMIT_SURVEY // preChatSurvey / no surveyData so closing thank you window and showing panel'; </span>
<span class="cstat-no" title="statement not covered" >      _triggerEvent(_config.EVENTS.SHOW, eventData);</span>
<span class="cstat-no" title="statement not covered" >      closeThankyouWindow();    </span>
    }
<span class="cstat-no" title="statement not covered" >    if (options.data.surveyType == 'postChatSurvey') {</span>
<span class="cstat-no" title="statement not covered" >      eventData.reason = 'BEFORE_SUBMIT_SURVEY // postChatSurvey / closing thank you window and showing panel';</span>
<span class="cstat-no" title="statement not covered" >      _triggerEvent(_config.EVENTS.SHOW, eventData);    </span>
<span class="cstat-no" title="statement not covered" >      closeThankyouWindow();</span>
    }
    
<span class="cstat-no" title="statement not covered" >    return options;</span>
  }
&nbsp;
  function addSurveyHooks() {
    var _waitForHooks = setInterval(<span class="fstat-no" title="function not covered" >function () {</span>
<span class="cstat-no" title="statement not covered" >      var _waitForHooksCounter = 0;</span>
<span class="cstat-no" title="statement not covered" >      if (lpTag &amp;&amp; lpTag.hooks &amp;&amp; lpTag.hooks) {</span>
<span class="cstat-no" title="statement not covered" >        clearInterval(_waitForHooks);</span>
<span class="cstat-no" title="statement not covered" >        lpTag.hooks.push({</span>
          name: 'BEFORE_SUBMIT_SURVEY',
          callback: _handleBeforeSurveySubmitHook
        });
      } else <span class="cstat-no" title="statement not covered" >if (_waitForHooksCounter &gt; 10) {</span>
<span class="cstat-no" title="statement not covered" >        _log('clearInterval/_waitForHooksCounter', { '_waitForHooksCounter': _waitForHooksCounter });</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >        clearInterval(_waitForHooks); </span>// stop looping for hooks after 2 seconds
      }
    }, 200);
  }
&nbsp;
  function bindToChatEvents() {
    
    // make sure the function and objects exist
    <span class="missing-if-branch" title="else path not taken" >E</span>if (lpTag &amp;&amp; lpTag.events &amp;&amp; lpTag.events.bind) {
      _log('bindToChatEvents', { });
&nbsp;
      lpTag.events.bind('lpUnifiedWindow', 'state', function (eventData, d) {
        /* 
        lpUnifiedWindow/state 
          tracks the state of the window itself
          possible values from e.state object:
          init / initialised / waiting / chatting / interactive / resume
       */
&nbsp;
        <span class="missing-if-branch" title="else path not taken" >E</span>if (eventData.state == 'preChat' || <span class="branch-1 cbranch-no" title="branch not covered" >eventData.state == 'waiting' </span>|| <span class="branch-2 cbranch-no" title="branch not covered" >eventData.state == 'resume' </span>|| <span class="branch-3 cbranch-no" title="branch not covered" >eventData.state == 'interactive'|</span>| <span class="branch-4 cbranch-no" title="branch not covered" >eventData.state == 'postChat')</span> {
          _triggerEvent(_config.EVENTS.HIDE, {
            'eventData.state':eventData.state,
            'reason': 'lpUnifiedWindow State = '+eventData.state
          });
        }
      });
&nbsp;
      lpTag.events.bind('lpUnifiedWindow', 'conversationInfo', function (eventData, appName) {
        /* 
        This event tracks the state of the conversation itself
          eventData.state ...
            ended : chat ended
            postChat: post chat survey shown
            applicationEnded : post chat survey submitted     
       */
&nbsp;
        // workaround for #CMBWSUAT-31
        // added resume state in case page is ever refreshed, we need to re-add the click event bindings on the X close button!
        <span class="missing-if-branch" title="if path not taken" >I</span>if (eventData.state == 'preChat' || eventData.state == 'resume') {
          // when the prechat survey is shown attach a click event listener to the close button of the window.
          // if this is clicked the checkWindowStatus function is then called to see if the survey was completed or not.
<span class="cstat-no" title="statement not covered" >          var matches = document.getElementsByClassName(_config.WINDOW_CLOSE_BUTTON_CLASS);</span>
<span class="cstat-no" title="statement not covered" >          for (var i = 0; i &lt; matches.length; i++) {</span>
<span class="cstat-no" title="statement not covered" >            matches[i].addEventListener('click', checkWindowStatus, true);</span>
          }
&nbsp;
        }
&nbsp;
        // if the post chat exit survey has been submitted then auto close the thank you window
        if (eventData.state == 'applicationEnded') {
          closeThankyouWindow();
          _triggerEvent(_config.EVENTS.SHOW, {
            'eventData.state': eventData.state,
            'reason': 'lpUnifiedWindow conversationInfo  ' + eventData.state + ' event fired = post chat survey has been submitted'
          });
          // showVaPanel();
        }
&nbsp;
        <span class="missing-if-branch" title="if path not taken" >I</span>if (eventData.state == 'ended') {
<span class="cstat-no" title="statement not covered" >          checkWindowStatus();</span>
        }
&nbsp;
      });
&nbsp;
      lpTag.events.bind('LP_OFFERS', 'OFFER_IMPRESSION', checkIfButtonImpressionIsForVaPanel);
&nbsp;
      // custom event to react to when other parts of the code detect the button loaded on the page is for the VA Panel
      lpTag.events.bind(_config.NAMESPACE, _config.EVENTS.BUTTON_IMPRESSION, showTheLivePersonButtonInsideVaPanel);
&nbsp;
    }
&nbsp;
  }
&nbsp;
<span class="fstat-no" title="function not covered" >  function triggerChatButtonClick(faqHistorySoFar) {</span>
    // DOCS: https://developers.liveperson.com/trigger-click.html
<span class="cstat-no" title="statement not covered" >    var clicked;</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >    if (lpTag &amp;&amp; lpTag.taglets &amp;&amp; lpTag.taglets.rendererStub) {</span>
<span class="cstat-no" title="statement not covered" >      if (_config.SEND_FAQ_CONVERSATION_AS_PRECHAT_LINES &amp;&amp; faqHistorySoFar.length &gt; 0) {</span>
        // grab FAQ lines...this POC just gets the HTML content from specific class elements...you will use your own API and functions to get this information from the chat in progress.
        // var preChatLinesArray = addPreChatLinesToChat();
<span class="cstat-no" title="statement not covered" >        var preChatLinesIntroMessages = getPreChatLinesIntroMessages();</span>
<span class="cstat-no" title="statement not covered" >        var preChatLinesArray = [];</span>
<span class="cstat-no" title="statement not covered" >        if(preChatLinesIntroMessages) {</span>
<span class="cstat-no" title="statement not covered" >          preChatLinesArray.push(preChatLinesIntroMessages);</span>
        } else <span class="cstat-no" title="statement not covered" >if (preChatLinesIntroMessages === false) {</span>
          // we could not find a cart item which matched a supported language in our translation list, therefore we do not have any intro messages to add to the conversation
        }
<span class="cstat-no" title="statement not covered" >        preChatLinesArray = preChatLinesArray.concat(faqHistorySoFar);</span>
        // if preChatLinesContent.length &gt; 0 then we have been supplied with faq history so far.
        // UPDATE : DO NOT SEND preChatLines if empty! otherwise this will cause the 400 bad request error in the chat window
<span class="cstat-no" title="statement not covered" >        var preChatLinesSuffixMessage = getPreChatLinesSuffixMessages();</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >        if (preChatLinesSuffixMessage) {</span>
<span class="cstat-no" title="statement not covered" >          preChatLinesArray.push(preChatLinesSuffixMessage);</span>
        }
&nbsp;
<span class="cstat-no" title="statement not covered" >        if (preChatLinesArray.length &gt; 0) {</span>
<span class="cstat-no" title="statement not covered" >          clicked = lpTag.taglets.rendererStub.click(_config.EMBEDDED_BUTTON_INFO.id, {</span>
            preChatLines: preChatLinesArray
          });
        } else {
<span class="cstat-no" title="statement not covered" >          clicked = lpTag.taglets.rendererStub.click(_config.EMBEDDED_BUTTON_INFO.id); </span>// this will open the chat window
        }
&nbsp;
      } else {
<span class="cstat-no" title="statement not covered" >        clicked = lpTag.taglets.rendererStub.click(_config.EMBEDDED_BUTTON_INFO.id); </span>// this will open the chat window
      }
&nbsp;
    }
  }
&nbsp;
<span class="fstat-no" title="function not covered" >  function getCurrentCountrySelection(){</span>
&nbsp;
  }
&nbsp;
<span class="fstat-no" title="function not covered" >  function isSupportedLanguage(lang) {</span>
<span class="cstat-no" title="statement not covered" >    var supportedLanguage = false;</span>
<span class="cstat-no" title="statement not covered" >    if(_supportedLanguages.indexOf(lang) &gt; -1) {</span>
<span class="cstat-no" title="statement not covered" >      supportedLanguage = true;</span>
    }
<span class="cstat-no" title="statement not covered" >    return supportedLanguage;</span>
  }
&nbsp;
<span class="fstat-no" title="function not covered" >  function getCurrentLanguageSelection(){</span>
<span class="cstat-no" title="statement not covered" >    var cartItems = lpTag.sdes.get('cart')[0] || false;</span>
<span class="cstat-no" title="statement not covered" >    var foundSupportedLanguage = false;</span>
<span class="cstat-no" title="statement not covered" >    var currentLanguageSelection = null;</span>
<span class="cstat-no" title="statement not covered" >    if(cartItems &amp;&amp; cartItems.products &amp;&amp; cartItems.products.length) {</span>
<span class="cstat-no" title="statement not covered" >      for (let i = 0; i &lt; cartItems.products.length; i++) {</span>
<span class="cstat-no" title="statement not covered" >        const possibleLanguageSelection = cartItems.products[i].product.name || null;</span>
<span class="cstat-no" title="statement not covered" >        if(isSupportedLanguage(possibleLanguageSelection)) {</span>
<span class="cstat-no" title="statement not covered" >          currentLanguageSelection = possibleLanguageSelection;</span>
<span class="cstat-no" title="statement not covered" >          foundSupportedLanguage = true;</span>
<span class="cstat-no" title="statement not covered" >          break;</span>
        }
      }
    }
<span class="cstat-no" title="statement not covered" >    return currentLanguageSelection;</span>
  }
&nbsp;
<span class="fstat-no" title="function not covered" >  function getPreChatLinesIntroTranslation() {</span>
<span class="cstat-no" title="statement not covered" >    var language = getCurrentLanguageSelection();</span>
<span class="cstat-no" title="statement not covered" >    if(language) {</span>
<span class="cstat-no" title="statement not covered" >      return _translations.intro[language];</span>
    } else {
<span class="cstat-no" title="statement not covered" >      return false;</span>
    }
  }
&nbsp;
<span class="fstat-no" title="function not covered" >  function getPreChatLinesSuffixTranslation(){</span>
<span class="cstat-no" title="statement not covered" >    var language = getCurrentLanguageSelection();</span>
<span class="cstat-no" title="statement not covered" >    if (language) {</span>
<span class="cstat-no" title="statement not covered" >      return _translations.suffix[language];</span>
    } else {
<span class="cstat-no" title="statement not covered" >      return false;</span>
    }
  }
&nbsp;
<span class="fstat-no" title="function not covered" >  function getPreChatLinesIntroMessages() {</span>
<span class="cstat-no" title="statement not covered" >    var preChatLinesIntroMessage = getPreChatLinesIntroTranslation();</span>
<span class="cstat-no" title="statement not covered" >    return preChatLinesIntroMessage || false;</span>
  }
&nbsp;
<span class="fstat-no" title="function not covered" >  function getPreChatLinesSuffixMessages() {</span>
<span class="cstat-no" title="statement not covered" >    var preChatLinesSuffixMessage = getPreChatLinesSuffixTranslation();</span>
<span class="cstat-no" title="statement not covered" >    return preChatLinesSuffixMessage || false;</span>
  }
&nbsp;
  function closeThankyouWindow() {
    var closeBtn = document.querySelector('.lp_close'); // this is the class of the close button
&nbsp;
    // if we find it, click to close the thank you screen
    <span class="missing-if-branch" title="if path not taken" >I</span>if (closeBtn) {
<span class="cstat-no" title="statement not covered" >      closeBtn.click();</span>
<span class="cstat-no" title="statement not covered" >      _triggerEvent(_config.EVENTS.CLOSE_THANKYOU_WINDOW, {</span>
        'info': 'attempted to close thank you window'
      });
    }
  }
&nbsp;
&nbsp;
<span class="fstat-no" title="function not covered" >  function checkButtonState() {</span>
    // example of how you can query the lpTag and get the latest button state for a unique button engagement id
    // 1 = online
    // 2 = offline
    // 4 = busy
<span class="cstat-no" title="statement not covered" >    var buttonState = 0;</span>
<span class="cstat-no" title="statement not covered" >    if (_config.EMBEDDED_BUTTON_INFO &amp;&amp; _config.EMBEDDED_BUTTON_INFO.id) {</span>
<span class="cstat-no" title="statement not covered" >      var buttonState = lpTag.taglets.rendererStub.getEngagementState(_config.EMBEDDED_BUTTON_INFO.id).state; </span>// use the number you grabbed earlier when the button was loaded inside the panel
    }
<span class="cstat-no" title="statement not covered" >    return buttonState;</span>
  }
&nbsp;
<span class="fstat-no" title="function not covered" >  function agentsAreAvailable() {</span>
<span class="cstat-no" title="statement not covered" >    return checkButtonState() == BUTTON_STATES.ONLINE ? true : false;</span>
  }
<span class="fstat-no" title="function not covered" >  function agentsAreBusy() {</span>
<span class="cstat-no" title="statement not covered" >    return checkButtonState() == BUTTON_STATES.BUSY ? true : false;</span>
  }
<span class="fstat-no" title="function not covered" >  function agentsAreOffline() {</span>
<span class="cstat-no" title="statement not covered" >    return checkButtonState() == BUTTON_STATES.OFFLINE ? true : false;</span>
  }
&nbsp;
<span class="fstat-no" title="function not covered" >  function startChat(conversationSoFar) {</span>
<span class="cstat-no" title="statement not covered" >    var preChatLines = conversationSoFar || [];</span>
<span class="cstat-no" title="statement not covered" >    var state = checkButtonState();</span>
    // only trigger the click function if the button is ONLINE
&nbsp;
<span class="cstat-no" title="statement not covered" >    if ( </span>
      (state == BUTTON_STATES.BUSY &amp;&amp; _config.TRIGGER_CHAT_BUTTON_FROM_BUSY_STATE)
      ||
      (state == BUTTON_STATES.OFFLINE &amp;&amp; _config.TRIGGER_CHAT_BUTTON_FROM_OFFLINE_STATE)
      ||
      (state == BUTTON_STATES.ONLINE)
    ) {
<span class="cstat-no" title="statement not covered" >      triggerChatButtonClick(preChatLines);</span>
    } else {
      //ToDo trigger event
<span class="cstat-no" title="statement not covered" >      return false;</span>
    }
&nbsp;
  }
&nbsp;
&nbsp;
<span class="fstat-no" title="function not covered" >  function _toggleClass(selector, className) {</span>
<span class="cstat-no" title="statement not covered" >    var el = document.querySelector(selector);</span>
<span class="cstat-no" title="statement not covered" >    if (el.classList) {</span>
<span class="cstat-no" title="statement not covered" >      el.classList.toggle(className);</span>
    } else {
<span class="cstat-no" title="statement not covered" >      var classes = el.className.split(' ');</span>
<span class="cstat-no" title="statement not covered" >      var existingIndex = classes.indexOf(className);</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >      if (existingIndex &gt;= 0)</span>
<span class="cstat-no" title="statement not covered" >        classes.splice(existingIndex, 1);</span>
      else
<span class="cstat-no" title="statement not covered" >        classes.push(className);</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >      el.className = classes.join(' ');</span>
    }
  }
&nbsp;
<span class="fstat-no" title="function not covered" >  function _removeClass(selector, className) {</span>
<span class="cstat-no" title="statement not covered" >    var el = document.querySelector(selector);</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >    if (el.classList) {</span>
<span class="cstat-no" title="statement not covered" >      el.classList.remove(className);</span>
    }
    else {
<span class="cstat-no" title="statement not covered" >      el.className = el.className.replace(new RegExp('(^|\\b)' + className.split(' ').join('|') + '(\\b|$)', 'gi'), ' ');</span>
    }
&nbsp;
  }
&nbsp;
  function injectLivePersonEmbeddedButtonContainer() {
    /* 
      At this point the panel is shown and the &lt;div&gt; with the required specific id for LivePerson to deploy the button into does not exist in the DOM
      Therefore, this code adds that div with that id to the DOM dynamically
      Once this has been done, you MUST register this with LivePerson as shown below so that our tag can search again for the container div matching the id we provide, and deploy the button content accordingly.
    */
&nbsp;
    /*************** 
        CRUCIAL
    ****************/
    // only do this once! we only need to create the div tag once when first showing the panel on each page load
    <span class="missing-if-branch" title="else path not taken" >E</span>if (!document.getElementById(_config.EMBEDDED_BUTTON_DIV_CONTAINER_ID)) {
      // if the div id has NOT already been created, then make one and add to the panel in the required position with the required id
      var buttonContainer = document.getElementById('button-container');
      var buttonDiv = document.createElement('div');
      buttonDiv.id = _config.EMBEDDED_BUTTON_DIV_CONTAINER_ID;
      buttonContainer.appendChild(buttonDiv);
      // register button div zone with LivePerson now div exists within the DOM   
      // THIS IS CRUCIAL -it tells our system that the container div for the button now exists and can be attempted to be injected onto the page - in either online/offline state. 
      var sdes = [{
        'type': 'pagediv',
        'divId': _config.EMBEDDED_BUTTON_DIV_CONTAINER_ID
      }];
      _log('injectButtonContainerId',{
        'sdes':sdes,
        'buttonContainer': buttonContainer,
        'buttonDiv': buttonDiv,
      });
      <span class="missing-if-branch" title="else path not taken" >E</span>if (lpTag &amp;&amp; lpTag.sdes &amp;&amp; lpTag.sdes.send) {
        lpTag.sdes.send(sdes);
      } else <span class="cstat-no" title="statement not covered" >if (lpTag &amp;&amp; lpTag.sdes.push) {</span>
<span class="cstat-no" title="statement not covered" >        lpTag.sdes.push(sdes);</span>
      }
      // ^ The above will tell LP that the div now exists and is ready to receive the content - online/offline/busy etc...
    }
  }
&nbsp;
<span class="fstat-no" title="function not covered" >  function getEventLog() {</span>
<span class="cstat-no" title="statement not covered" >    return _eventLog;</span>
  }
&nbsp;
  // Reveal public pointers to
  // private functions and properties
&nbsp;
  return {
    version:_version,
    start: _init,
    init: _init,
    injectButtonContainer: injectLivePersonEmbeddedButtonContainer,
    escalateToChat: startChat,
    startChat: startChat,
    agentsAreAvailable: agentsAreAvailable,
    agentsAreBusy: agentsAreBusy,
    agentsAreOffline: agentsAreOffline,
    getActiveButton:getActiveButton,
    getEventLog:getEventLog
  };
&nbsp;
})();</pre></td></tr>
</table></pre>
<div class='push'></div><!-- for sticky footer -->
</div><!-- /wrapper -->
<div class='footer quiet pad2 space-top1 center small'>
  Code coverage
  generated by <a href="http://istanbul-js.org/" target="_blank">istanbul</a> at Tue Dec 19 2017 17:53:39 GMT+0000 (GMT)
</div>
</div>
<script src="../prettify.js"></script>
<script>
window.onload = function () {
        if (typeof prettyPrint === 'function') {
            prettyPrint();
        }
};
</script>
<script src="../sorter.js"></script>
</body>
</html>
